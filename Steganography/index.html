<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <title>Steganography</title>
        <link rel="icon" href="./Resources/js_icon.jpg" type="jpg">
    </head>
    <body style="background-color: rgb(44, 46, 54); color: whitesmoke; font-size: 24px;">
        
        <input type="file" id="source">
        <div>
            <button onclick="window.functions[0]()">Single Bytes</button>
        </div>
        <p id="display" style="word-break: break-word; max-width: 95vw;"></p>
        <button id="continue" onclick="proceed()" disabled="true">Execute</button>

        <script type="module">
            import { Reader } from "./Code/src/reader.js";
            import { URICompressor } from "./Code/src/compression.js";
            var Main = new Reader("source");
            window.main = Main;
            window.functions = new Array();

            window.functions.push(async function() //compress
            {
                var file = await window.main.readSingleAsBinary();
                var size1 = Math.floor(file.data.length/8);
                file.data = URICompressor.compress(file.data);
                var size2 = Math.floor(file.data.length/8);
                console.log("Compression reduced file from " + size1 + " bytes to " + size2 + " bytes (" + size2/size1 + ")");
                document.getElementById("display").innerHTML = JSON.stringify(file);
                return file;
            });
            window.functions.push(async function() //decompress
            {
                var data = await window.functions[2]();
                console.log(data.name);
                console.log(Math.floor(data.data.length / 8));
                var holder = URICompressor.decompress(data.data);
                data.data = holder;
                console.log(Math.floor(data.data.length / 8));
                document.getElementById("display").innerHTML = JSON.stringify(data);
                return data;
            });

            setInterval(function(){
                if(window.main.done == true && document.getElementById("source").files.length > 0)
                {
                    document.getElementById("continue").disabled = false;
                }
                else
                {
                    document.getElementById("continue").disabled = true;
                }
            }, 1000);
        </script>

        <script>
            function navigateRoot()
            {
                window.location.href = "./index.html";
            }
            function proceed()
            {
                alert("program execution would now countine");
            }
        </script>

        <hr>
        <i style="color: whitesmoke;">This tool was developed by Brendan Rood in the spring of 2024</i>
    </body>
</html>
